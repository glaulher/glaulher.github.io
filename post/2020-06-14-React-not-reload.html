<!DOCTYPE html><html class="dark" lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Blog Post-it - tips software developer</title><meta name="next-head-count" content="3"/><meta name="description" content="tips to Software engineer"/><link rel="shortcut icon" href="/icons/favicon.ico"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><link rel="preload" href="/_next/static/css/04e02596364ce873.css" as="style"/><link rel="stylesheet" href="/_next/static/css/04e02596364ce873.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee7e63bc15b31913.js" defer=""></script><script src="/_next/static/chunks/framework-2c79e2a64abdb08b.js" defer=""></script><script src="/_next/static/chunks/main-5020794388548d5e.js" defer=""></script><script src="/_next/static/chunks/pages/_app-30a1d01c74426c01.js" defer=""></script><script src="/_next/static/chunks/102-30d1c8029cc75d07.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-61254d52b7c74ec7.js" defer=""></script><script src="/_next/static/wFuZMLcTQ1pdCdZORTuCR/_buildManifest.js" defer=""></script><script src="/_next/static/wFuZMLcTQ1pdCdZORTuCR/_ssgManifest.js" defer=""></script><style data-href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0&display=swap">@font-face{font-family:'Material Symbols Outlined';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/materialsymbolsoutlined/v100/kJF1BvYX7BgnkSrUwT8OhrdQw4oELdPIeeII9v6oDMzByHX9rA6RzaxHMPdY43zj-jCxv3fzvRNU22ZXGJpEpjC_1n-q_4MrImHCIJIZrDCvHOel.woff) format('woff')}.material-symbols-outlined{font-family:'Material Symbols Outlined';font-weight:normal;font-style:normal;font-size:24px;line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;font-feature-settings:'liga'}@font-face{font-family:'Material Symbols Outlined';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/materialsymbolsoutlined/v100/kJF1BvYX7BgnkSrUwT8OhrdQw4oELdPIeeII9v6oDMzByHX9rA6RzaxHMPdY43zj-jCxv3fzvRNU22ZXGJpEpjC_1n-q_4MrImHCIJIZrDCvHOelbd5zrDAt.woff) format('woff')}.material-symbols-outlined{font-family:'Material Symbols Outlined';font-weight:normal;font-style:normal;font-size:24px;line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-feature-settings:'liga';-webkit-font-smoothing:antialiased}</style></head><body class="transition transform duration-700 ease-in-out dark:bg-slate-800"><div id="__next"><script>!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><div class="flex flex-col min-h-screen"><header class="bg-gray-700 mb-3 px-6 py-4 "><div class="container lg:mx-auto md:mx-auto flex justify-center"><a href="/"><img alt="Menu" src="/menuIcons/svgviewer-output.svg" width="60" height="60" decoding="async" data-nimg="1" class=" -mb-4 -mt-3 " loading="lazy" style="color:transparent"/></a><a href="/"><p class="text-lg ml-4 -mt-4 text-neutral-200 hover:text-sky-700">Bem vindo ao</p><p class="text-lg ml-8 -mb-4 text-neutral-200 hover:text-sky-700">Blog Post-it</p></a><div class=" ml-auto text-neutral-200"><button type="button" aria-label="Toggle dark mode"><span class="hover:text-sky-700 material-symbols-outlined"></span></button></div></div></header><main class="container mx-auto flex-1"><div class="prose dark:prose-invert mx-auto"><a href="/"><p class="absolute right-10 text-sm mt-2 dark:text-neutral-200 hover:text-sky-700 dark:hover:text-sky-700">Voltar ↵</p></a><div class="relative flex justify-center ml-1 mr-24"><span class="text-xl font-bold md:text-3xl">React não recarrega a página ao salvar no linux</span></div><div class="mx-1"><hr/>
<p>![image]({{ &quot;/assets/img/sample/react-reload/reload.png&quot; | relative_url }})</p>
<!-- -->&lt;div style=&quot;text-align: justify&quot;&gt;  
Para resolver esse problema é preciso alterar o valor  de max_user_watches em inotify, cada relógio inotify usado ocupa 540 bytes (sistema de 32 bits) ou 1 kB (duplo em 64 bits) Isso sai da memória do kernel, que não pode ser trocada. Supondo que você definiu o máximo em 524288 e todos foram usados (improvável), você usaria aproximadamente 256 MB / 512 MB de memória do kernel de 32 bits / 64 bits.&lt;br /&gt;
&lt;br /&gt;
Observe que seu aplicativo também utilizará memória adicional para acompanhar os identificadores inotify, os caminhos de arquivo / no diretório etc.&lt;br /&gt;
&lt;br /&gt;&lt;/div&gt;<!-- -->
<p>Para verificar o número máximo de relógios inotify:</p>
<pre><pre style="color:#e3eaf2;background:#111b27;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto"><code class="language-shell" style="color:#e3eaf2;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#c699e3">cat</span><span> /proc/sys/fs/inotify/max_user_watches</span></code></pre></pre>
<p>No Debian esse valor padrão é 8192, para definir o número máximo de relógios inotify temporariamente:</p>
<pre><pre style="color:#e3eaf2;background:#111b27;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto"><code class="language-shell" style="color:#e3eaf2;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span> </span><span class="token" style="color:#c699e3">sudo</span><span> sysctl fs.inotify.max_user_watches </span><span class="token" style="color:#e9ae7e">=</span><span> com o seu valor preferido no final.</span></code></pre></pre>
<p><strong>Para definir o número máximo de relógios inotify definitivamente:</strong></p>
<pre><pre style="color:#e3eaf2;background:#111b27;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto"><code class="language-shell" style="color:#e3eaf2;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#c699e3">sudo</span><span> -i
</span><span></span><span class="token" style="color:#6cb8e6">echo</span><span> </span><span class="token" style="color:#91d076">&quot;fs.inotify.max_user_watches=524288&quot;</span><span> </span><span class="token" style="color:#e9ae7e">|</span><span class="token" style="color:#c699e3">tee</span><span> -a /etc/sysctl.conf
</span>sysctl -p
<span></span><span class="token" style="color:#6cb8e6">exit</span></code></pre></pre>
<!-- -->&lt;div style=&quot;text-align: justify&quot;&gt; 
Permanentemente (informações mais detalhadas):&lt;br /&gt;<!-- -->
<p>Coloque fs.inotify.max_user_watches = 524288 nas configurações do sysctl. Dependendo do seu sistema, eles podem estar em um dos seguintes locais:<!-- -->&lt;br /&gt;<!-- -->
Debian / RedHat: /etc/sysctl.conf<!-- -->&lt;br /&gt;<!-- -->
Arch: coloque um novo arquivo em /etc/sysctl.d/, por exemplo /etc/sysctl.d/40-max-user-watches.conf<!-- -->&lt;br /&gt;<!-- -->
Você pode recarregar as configurações do sysctl para evitar uma reinicialização: sysctl -p (Debian / RedHat) ou sysctl --system (Arch)<!-- -->&lt;br /&gt;<!-- -->
Verifique se o número máximo de relógios inotify foi atingido:<!-- -->&lt;br /&gt;</p>
<p>Use tail com a opção -f (follow) em qualquer arquivo antigo, por exemplo tail -f / var / log / dmesg: - Se estiver tudo bem, mostrará as últimas 10 linhas e fará uma pausa; abortar com Ctrl-C - Se você estiver sem relógio, falhará com este erro um tanto enigmático:</p>
<!-- -->&lt;/div&gt;&lt;br /&gt;<!-- -->
<pre><pre style="color:#e3eaf2;background:#111b27;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto"><code class="language-shell" style="color:#e3eaf2;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>tail: cannot </span><span class="token" style="color:#c699e3">watch</span><span> </span><span class="token" style="color:#91d076">&#x27;/var/log/dmsg&#x27;</span><span class="token" style="color:#6cb8e6">:</span><span> No space left on device</span></code></pre></pre>
<p>Para ver o que está usando os relógios inotify:</p>
<pre><pre style="color:#e3eaf2;background:#111b27;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto"><code class="language-shell" style="color:#e3eaf2;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#c699e3">find</span><span> /proc/*/fd -lname anon_inode:inotify </span><span class="token" style="color:#e9ae7e">|</span><span>
</span><span>   </span><span class="token" style="color:#c699e3">cut</span><span> -d/ -f3 </span><span class="token" style="color:#e9ae7e">|</span><span>
</span><span>   </span><span class="token" style="color:#c699e3">xargs</span><span> -I </span><span class="token" style="color:#91d076">&#x27;{}&#x27;</span><span> -- </span><span class="token" style="color:#c699e3">ps</span><span> --no-headers -o </span><span class="token" style="color:#91d076">&#x27;%p %U %c&#x27;</span><span> -p </span><span class="token" style="color:#91d076">&#x27;{}&#x27;</span><span> </span><span class="token" style="color:#e9ae7e">|</span><span>
</span><span>   </span><span class="token" style="color:#c699e3">uniq</span><span> -c </span><span class="token" style="color:#e9ae7e">|</span><span>
</span><span>   </span><span class="token" style="color:#c699e3">sort</span><span> -nr</span></code></pre></pre>
<p>A primeira coluna indica o número de inotify fds (embora não seja o número de relógios) e a segunda mostra o PID desse processo.</p>
<p>fontes:</p>
<p><a href="https://askubuntu.com/questions/716431/inotify-max-user-watches-value-resets-on-reboot-how-to-change-it-permanently">askbuntu</a>{:target=&quot;_blank&quot; rel=&quot;noopener&quot;}</p>
<p><a href="https://dev.to/rubiin/ubuntu-increase-inotify-watcher-file-watch-limit-kf4">dev.to</a>{:target=&quot;_blank&quot; rel=&quot;noopener&quot;}</p>
<p><a href="https://stackoverflow.com/questions/42189575/create-react-app-reload-not-working">stackoverflow</a>{:target=&quot;_blank&quot; rel=&quot;noopener&quot;}</p></div></div></main><footer class="bg-gray-700 mt-1 py-4"><div class="container mx-auto flex justify-center"><span class="mx-auto text-neutral-200">© 2023 GrmDevTips</span></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"frontmatter":{"title":"React não recarrega a página ao salvar no linux","author":"Glaulher Medeiros","socialImage":"images/banner/22-09-2021.jpg","date":"2020-06-14T15:27:00.000Z","categories":["Blogging","Tutorial"],"tags":["React","Linux"],"toc":true,"comments":true},"content":"***\n\n![image]({{ \"/assets/img/sample/react-reload/reload.png\" | relative_url }})\n\n\u003cdiv style=\"text-align: justify\"\u003e  \nPara resolver esse problema é preciso alterar o valor  de max_user_watches em inotify, cada relógio inotify usado ocupa 540 bytes (sistema de 32 bits) ou 1 kB (duplo em 64 bits) Isso sai da memória do kernel, que não pode ser trocada. Supondo que você definiu o máximo em 524288 e todos foram usados (improvável), você usaria aproximadamente 256 MB / 512 MB de memória do kernel de 32 bits / 64 bits.\u003cbr /\u003e\n\u003cbr /\u003e\nObserve que seu aplicativo também utilizará memória adicional para acompanhar os identificadores inotify, os caminhos de arquivo / no diretório etc.\u003cbr /\u003e\n\u003cbr /\u003e\u003c/div\u003e\n\nPara verificar o número máximo de relógios inotify:  \n\n```shell\ncat /proc/sys/fs/inotify/max_user_watches\n```\n\nNo Debian esse valor padrão é 8192, para definir o número máximo de relógios inotify temporariamente:\n\n```shell\n sudo sysctl fs.inotify.max_user_watches = com o seu valor preferido no final.\n```\n\n**Para definir o número máximo de relógios inotify definitivamente:**\n\n```shell\nsudo -i\necho \"fs.inotify.max_user_watches=524288\" |tee -a /etc/sysctl.conf\nsysctl -p\nexit\n```\n\n\n\u003cdiv style=\"text-align: justify\"\u003e \nPermanentemente (informações mais detalhadas):\u003cbr /\u003e\n\nColoque fs.inotify.max_user_watches = 524288 nas configurações do sysctl. Dependendo do seu sistema, eles podem estar em um dos seguintes locais:\u003cbr /\u003e\nDebian / RedHat: /etc/sysctl.conf\u003cbr /\u003e\nArch: coloque um novo arquivo em /etc/sysctl.d/, por exemplo /etc/sysctl.d/40-max-user-watches.conf\u003cbr /\u003e\nVocê pode recarregar as configurações do sysctl para evitar uma reinicialização: sysctl -p (Debian / RedHat) ou sysctl --system (Arch)\u003cbr /\u003e\nVerifique se o número máximo de relógios inotify foi atingido:\u003cbr /\u003e\n\nUse tail com a opção -f (follow) em qualquer arquivo antigo, por exemplo tail -f / var / log / dmesg: - Se estiver tudo bem, mostrará as últimas 10 linhas e fará uma pausa; abortar com Ctrl-C - Se você estiver sem relógio, falhará com este erro um tanto enigmático:\n\u003c/div\u003e\u003cbr /\u003e\n\n```shell\ntail: cannot watch '/var/log/dmsg': No space left on device\n```\nPara ver o que está usando os relógios inotify:\n\n```shell\nfind /proc/*/fd -lname anon_inode:inotify |\n   cut -d/ -f3 |\n   xargs -I '{}' -- ps --no-headers -o '%p %U %c' -p '{}' |\n   uniq -c |\n   sort -nr\n```\n\nA primeira coluna indica o número de inotify fds (embora não seja o número de relógios) e a segunda mostra o PID desse processo.\n\nfontes:\n\n[askbuntu]( https://askubuntu.com/questions/716431/inotify-max-user-watches-value-resets-on-reboot-how-to-change-it-permanently){:target=\"_blank\" rel=\"noopener\"}\n\n[dev.to](https://dev.to/rubiin/ubuntu-increase-inotify-watcher-file-watch-limit-kf4){:target=\"_blank\" rel=\"noopener\"}\n\n[stackoverflow](https://stackoverflow.com/questions/42189575/create-react-app-reload-not-working){:target=\"_blank\" rel=\"noopener\"}\n\n\n\n\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2020-06-14-React-not-reload"},"buildId":"wFuZMLcTQ1pdCdZORTuCR","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>